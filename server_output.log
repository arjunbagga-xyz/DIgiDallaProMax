
> instagram-automation@0.1.0 dev
> next dev

   ▲ Next.js 15.2.4
   - Local:        http://localhost:3000
   - Network:      http://192.168.0.2:3000

 ✓ Starting...
 ⚠ Invalid next.config.mjs options detected:
 ⚠     Unrecognized key(s) in object: 'serverComponentsExternalPackages' at "experimental"
 ⚠ See more info here: https://nextjs.org/docs/messages/invalid-next-config
 ⚠ `experimental.serverComponentsExternalPackages` has been moved to `serverExternalPackages`. Please update your next.config.mjs file accordingly.
 ✓ Ready in 1986ms
 ○ Compiling /api/workflows/generate-content ...
 ✓ Compiled /api/workflows/generate-content in 1097ms (362 modules)
Generated ComfyUI Workflow: {
  "1": {
    "inputs": {
      "ckpt_name": "v1-5-pruned-emaonly.safetensors"
    },
    "class_type": "CheckpointLoaderSimple",
    "_meta": {
      "title": "Load Checkpoint"
    }
  },
  "2": {
    "inputs": {
      "text": "a portrait of a mysterious person in a futuristic city, cinematic lighting",
      "clip": [
        "1",
        1
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode (Prompt)"
    }
  },
  "3": {
    "inputs": {
      "text": "ugly, tiling, poorly drawn hands",
      "clip": [
        "1",
        1
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode (Negative)"
    }
  },
  "4": {
    "inputs": {
      "width": 768,
      "height": 512,
      "batch_size": 1
    },
    "class_type": "EmptyLatentImage",
    "_meta": {
      "title": "Empty Latent Image"
    }
  },
  "5": {
    "inputs": {
      "seed": 816663,
      "steps": 25,
      "cfg": 7,
      "sampler_name": "euler_a",
      "scheduler": "normal",
      "denoise": 1,
      "model": [
        "1",
        0
      ],
      "positive": [
        "2",
        0
      ],
      "negative": [
        "3",
        0
      ],
      "latent_image": [
        "4",
        0
      ]
    },
    "class_type": "KSampler",
    "_meta": {
      "title": "KSampler (Base Pass)"
    }
  },
  "6": {
    "inputs": {
      "vae": [
        "1",
        2
      ],
      "samples": [
        "9",
        0
      ]
    },
    "class_type": "VAEDecode",
    "_meta": {
      "title": "VAE Decode"
    }
  },
  "7": {
    "inputs": {
      "filename_prefix": "sd15_generated_hires",
      "images": [
        "6",
        0
      ]
    },
    "class_type": "SaveImage",
    "_meta": {
      "title": "Save Image"
    }
  },
  "8": {
    "inputs": {
      "samples": [
        "5",
        0
      ],
      "upscale_method": "nearest-exact",
      "scale_by": 2
    },
    "class_type": "LatentUpscale",
    "_meta": {
      "title": "Upscale Latent"
    }
  },
  "9": {
    "inputs": {
      "seed": 816663,
      "steps": 15,
      "cfg": 7,
      "sampler_name": "euler_a",
      "scheduler": "normal",
      "denoise": 0.4,
      "model": [
        "1",
        0
      ],
      "positive": [
        "2",
        0
      ],
      "negative": [
        "3",
        0
      ],
      "latent_image": [
        "8",
        0
      ]
    },
    "class_type": "KSampler",
    "_meta": {
      "title": "KSampler (Hires Pass)"
    }
  }
}
Image generation failed: TypeError: fetch failed
    at async ComfyUIClient.generateImage (lib/comfyui.ts:110:28)
    at async POST (app/api/workflows/generate-content/route.ts:58:24)
  108 |
  109 |       // Queue the workflow
> 110 |       const queueResponse = await fetch(`${this.config.url}/prompt`, {
      |                            ^
  111 |         method: "POST",
  112 |         headers: {
  113 |           "Content-Type": "application/json", {
  [cause]: Error: connect ECONNREFUSED 127.0.0.1:8188
      at <unknown> (Error: connect ECONNREFUSED 127.0.0.1:8188) {
    errno: -111,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '127.0.0.1',
    port: 8188
  }
}
Failed to generate content: Error: fetch failed
    at POST (app/api/workflows/generate-content/route.ts:67:12)
  65 |
  66 |     if (!imageResult.success || !imageResult.imageData) {
> 67 |       throw new Error(imageResult.error || "Failed to generate image")
     |            ^
  68 |     }
  69 |
  70 |     // Step 3: Generate a caption from the image
 POST /api/workflows/generate-content 500 in 1570ms
